<head>
<title>3-DOF Crane Tower Equations.html</title>
<!-- Created by Maple 9.03, IBM INTEL NT -->
</head>
<body bgcolor="FFFFFF">
<basefont size="3">
<a name="MapleAutoBookmark1" />
<p align="center">
<b><u><font color="#000000" size="6">Dynamic Equations for the Tower of the 3-DOF Crane</font></u></b>
</p>
<p align="center">
<i><font color="#000000">©</font></i>
<i><font color="#000000">&nbsp;2006 Quanser Consulting Inc.</font></i>
</p>
<p align="center">
<font color="#000000">URL: </font>
<a href="http://www.quanser.com" target="_top">http://www.quanser.com</a></p>
<p align="center">
<font color="#000000" size="2">NOTE: This worksheet presents the general dynamic equations modelling a Double Inverted Pendulum mounted on a rotary arm.</font>
</p>
<p align="center"><a name="Description" />
</p>
<dl><a name="MapleAutoBookmark2" />
<p align="left">
<b><font color="#000000" size="5">Description</font></b>
</p>
<ul><li>
<font color="#000000">This worksheet presents the general dynamic equations modelling a rotary pendulum gantry system.</font>
</li>
<li>
<font color="#000000">Specifically, this worksheet is used to derive the state-space matrices for the </font>
<b><font color="#000000">Tower </font></b>
<font color="#000000">system on Quanser's </font>
<b><font color="#000000">3D Crane</font></b>
<font color="#000000">&nbsp;experiment.</font>
</li>
<li>
<font color="#000000">The resulting system has 3-Degrees-Of-Freedom (DOF) for motions in a three-dimensional space.</font>
</li>
<li>
<font color="#000000">The Lagrange's method is used to obtain the dynamic model of the system.</font>
</li>
<dl><a name="MapleAutoBookmark3" />
</ul>
<p align="left">
<b><font color="#000000" size="4">The </font></b>
<i><b><font color="#000000" size="4">Quanser_Tools</font></b></i>
<b><font color="#000000" size="4">&nbsp;Package</font></b>
</p>
<ul><li>
<font color="#000000">The </font>
<i><font color="#000000">Quanser_Tools</font></i>
<font color="#000000">&nbsp;module defines generic procedures and data in relation to determining the state-space representation of all the Quanser experiments. Specifically, this means deriving and solving the Lagrange's equations of the Quanser systems.</font>
</li>
<li>
<font color="#000000">The </font>
<i><font color="#000000">quanser</font></i>
<font color="#000000">&nbsp;repository containing the </font>
<i><font color="#000000">Quanser_Tools</font></i>
<font color="#000000">&nbsp;package is implemented in the 2 following files: </font>
<i><font color="#000000">quanser.ind</font></i>
<font color="#000000">&nbsp;and </font>
<i><font color="#000000">quanser.lib.</font></i>
<font color="#000000">&nbsp;If these two files are not readily available, they can be generated by executing the Maple worksheet titled: </font>
<i><font color="#000000">quanser_tools.mws</font></i>
<font color="#000000">.</font>
</li>
<li>
<b><font color="#000000">To install</font></b>
<font color="#000000">&nbsp;the </font>
<i><font color="#000000">Quanser_Tools</font></i>
<font color="#000000">&nbsp;package, copy the two files </font>
<i><font color="#000000">quanser.ind</font></i>
<font color="#000000">&nbsp;and </font>
<i><font color="#000000">quanser.lib</font></i>
<font color="#000000">&nbsp;&nbsp;into a directory of your choice, like for example: "C:\Program Files\Quanser\Maple Repository". </font>
</li>
<li>
<b><font color="#000000">To use</font></b>
<font color="#000000">&nbsp;the </font>
<i><font color="#000000">Quanser_Tools</font></i>
<font color="#000000">&nbsp;package in a Maple worksheet, add the path to its disk location to the Maple global variable </font>
<i><font color="#000000">libname</font></i>
<font color="#000000">. For example, this can be achieved by the following Maple command: <br />
libname := </font>
<i><font color="#000000">&nbsp;"C:/Program Files/Quanser/Maple Repository", libname:</font></i>
</li>
</dl><dl><a name="MapleAutoBookmark4" />
</ul>
<p align="left">
<b><font color="#000000" size="4">References</font></b>
</p>
<ul><li>
<font color="#000000">For additional control challenges offered by the Quanser please visit our website at: </font>
<a href="http://www.quanser.com/" target="_top">www.quanser.com</a></li>
</dl></ul>
<p align="left">
</p>
</dl><dl><a name="MapleAutoBookmark5" />
<p align="left">
<b><font color="#000000" size="5">Worksheet Initialization</font></b>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">restart: interface( imaginaryunit = j ): </font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">with( LinearAlgebra ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">libname := "C:/Program Files/Quanser/Maple Repository", ".", libname:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">with( Quanser_Tools );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations1.gif" width="930" height="20" alt="[HTM, deriveA, deriveB, deriveF, kinetic_energy, lagrange_equations, moment_of_inertia, n_norm, potential_energy, write_ABCD_to_Mfile]" />
</p>
<p align="left">
<font color="#000000">environment variable representing the order of series calculations</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Order := 2:</font></b>
</td></tr>
</table>
</p>
</dl><dl><a name="MapleAutoBookmark6" />
<p align="left"><a name="Notations" />
<b><font color="#000000" size="5">Notations</font></b>
</p>
<dl><a name="MapleAutoBookmark7" />
<p align="left">
<b><font color="#000000" size="4">Generalized Coordinates: </font></b>
<img src="images/3-DOF Crane Tower Equations2.gif" width="29" height="36" alt="q[i]" align="middle" />
<b><font color="#000000" size="4">'s</font></b>
</p>
<p align="left">
<font color="#000000">The generalized coordinates are also called Lagrangian coordinates.</font>
</p>
<p align="left">
<img src="images/3-DOF Crane Tower Equations3.gif" width="43" height="32" alt="theta(t)" align="middle" />
<font color="#000000">&nbsp;= &nbsp;base joint angle of rotary arm</font>
</p>
<p align="left">
<img src="images/3-DOF Crane Tower Equations4.gif" width="46" height="32" alt="alpha(t)" align="middle" />
<font color="#000000">&nbsp;= deflection angle of the payload that is perpendicular w.r.t. to the transversal of the rotary arm..</font>
</p>
<p align="left">
<font color="#000000">When </font>
<img src="images/3-DOF Crane Tower Equations5.gif" width="52" height="32" alt="alpha = 0" align="middle" />
<font color="#000000">&nbsp;</font>
<font color="#000000">the payload line, i.e. pendulum, is in the perfect downward position.</font>
</p>
<p align="left">
<font color="#000000">Np = number of links in pendulum</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Np := 1:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">q := [ theta(t), alpha(t) ];</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations6.gif" width="123" height="20" alt="q := [theta(t), alpha(t)]" />
</p>
<p align="left">
<font color="#000000">Nq = number of Lagrangian coordinates (e.g. here, it is Nq = 3)</font>
</p>
<p align="left">
<font color="#000000">Nq is also the number of position states.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Nq := nops( q ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">qd = first-order time derivative of the generalized coordinates, e.g. position and angular velocities</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">qd := map( diff, q, t );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations7.gif" width="167" height="45" alt="qd := [diff(theta(t),t), diff(alpha(t),t)]" />
</p>
</dl><dl><a name="MapleAutoBookmark8" />
<p align="left">
<b><font color="#000000" size="4">Transformation Matrices</font></b>
</p>
<p align="left">
<font color="#000000">T_0_1: rotation about the base axis </font>
<img src="images/3-DOF Crane Tower Equations8.gif" width="80" height="32" alt="rot(Z0,theta)" align="middle" />
<font color="#000000">.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">R[theta] := HTM( 'rot', 'Z', q[1] );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations9.gif" width="257" height="110" alt="R[theta] := Matrix(%id = 935620)" />
</p>
<p align="left">
<font color="#000000">T_1_2: translation to the trolley along the jib: T_1_2 = </font>
<img src="images/3-DOF Crane Tower Equations10.gif" width="94" height="32" alt="trans(X1,l[j])" align="middle" />
<font color="#000000">.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">T[lj] := HTM( 'trans', l[j], 0, 0 );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations11.gif" width="183" height="117" alt="T[lj] := Matrix(%id = 1098220)" />
</p>
<p align="left">
<font color="#000000">T_0_2: base coordinate to carriage position: T_0_2 = </font>
<img src="images/3-DOF Crane Tower Equations12.gif" width="80" height="32" alt="rot(Z0,theta)" align="middle" />
<font color="#000000">*</font>
<img src="images/3-DOF Crane Tower Equations13.gif" width="94" height="32" alt="trans(X1,lj)" align="middle" />
<font color="#000000">.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">T_0_2 := Multiply( R[theta], T[lj]);</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations14.gif" width="348" height="124" alt="T_0_2 := Matrix(%id = 1139748)" />
</p>
<p align="left">
<font color="#000000">From trolley position to gimble </font>
<img src="images/3-DOF Crane Tower Equations15.gif" width="27" height="32" alt="alpha" align="middle" />
<font color="#000000">&nbsp;deflection: T_2_3 = </font>
<img src="images/3-DOF Crane Tower Equations16.gif" width="84" height="32" alt="rot(X2,alpha)" align="middle" />
<font color="#000000">.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">R[alpha] := HTM( 'rot', 'X', q[2]);</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations17.gif" width="266" height="110" alt="R[alpha] := Matrix(%id = 19059412)" />
</p>
<p align="left">
<font color="#000000">From gimble deflection down to payload: T_3_4 = </font>
<img src="images/3-DOF Crane Tower Equations18.gif" width="105" height="32" alt="trans(Z3,-lp)" align="middle" />
<font color="#000000">.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">T[h] := HTM( 'trans', 0, 0, -l[p]);</font></b>
</td></tr>
</table>
</p>
<p align="left">
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations19.gif" width="182" height="117" alt="T[h] := Matrix(%id = 19115540)" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">T_2_4 := Multiply( R[alpha], T[h] );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations20.gif" width="369" height="124" alt="T_2_4 := Matrix(%id = 19163948)" />
</p>
<p align="left">
<font color="#000000">Base coordinate system to payload: T_0_4.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">T_0_4 := Multiply( T_0_2, T_2_4 );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations21.gif" width="707" height="131" alt="T_0_4 := Matrix(%id = 19210128)" />
</p>
</dl><p align="left">
</p>
<dl><a name="MapleAutoBookmark9" />
<p align="left">
<b><font color="#000000" size="4">Cartesian Coordinates of the Pendulum's Centre Of Gravity </font></b>
</p>
<p align="left">
<font color="#000000">conventions:</font>
</p>
<p align="left">
<font color="#000000">1) </font>
<img src="images/3-DOF Crane Tower Equations22.gif" width="52" height="32" alt="alpha = 0" align="middle" />
<font color="#000000">&nbsp;correspond to the payload wire being in the perfect downward position.</font>
</p>
<p align="left">
<font color="#000000">2) positive rotation of arm, </font>
<img src="images/3-DOF Crane Tower Equations23.gif" width="85" height="58" alt="0 &lt; diff(theta(t),t)" align="middle" />
<font color="#000000">, is CCW</font>
</p>
<p align="left">
<font color="#000000">3) positive rotation of gimble angle, </font>
<img src="images/3-DOF Crane Tower Equations24.gif" width="88" height="58" alt="0 &lt; diff(alpha(t),t)" align="middle" />
<font color="#000000">&nbsp;is also CCW.</font>
</p>
<p align="left">
<font color="#000000">Absolute 3-dimensional Cartesian position: carriage position.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">x[1] := T_0_2[1,4];<br />
y[1] := T_0_2[2,4];<br />
z[1] := T_0_2[3,4];<br />
</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations25.gif" width="127" height="27" alt="x[1] := cos(theta(t))*l[I]" />
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations26.gif" width="121" height="27" alt="y[1] := sin(theta(t))*l[I]" />
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations27.gif" width="58" height="27" alt="z[1] := 0" />
</p>
<p align="left">
<font color="#000000">Absolute 3-dimensional Cartesian position: payload position.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">x[2] := &nbsp;T_0_4[1,4];<br />
y[2] := &nbsp;T_0_4[2,4];<br />
z[2] := &nbsp;T_0_4[3,4];</font></b>
</td></tr>
</table>
</p>
<p align="left">
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations28.gif" width="290" height="27" alt="x[2] := -sin(theta(t))*sin(alpha(t))*l[p]+cos(theta(t))*l[I]" />
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations29.gif" width="280" height="27" alt="y[2] := cos(theta(t))*sin(alpha(t))*l[p]+sin(theta(t))*l[I]" />
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations30.gif" width="140" height="27" alt="z[2] := -cos(alpha(t))*l[p]" />
</p>
<p align="center">
</p>
<p align="left">
<font color="#000000">Absolute 3-dimensional Cartesian velocities.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">xd[1] := diff( x[1], t );<br />
yd[1] := diff( y[1], t );<br />
zd[1] := diff( z[1], t );<br />
xd[2] := diff( x[2], t );<br />
yd[2] := diff( y[2], t );<br />
zd[2] := diff( z[2], t );<br />
</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations31.gif" width="203" height="45" alt="xd[1] := -sin(theta(t))*diff(theta(t),t)*l[I]" />
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations32.gif" width="198" height="45" alt="yd[1] := cos(theta(t))*diff(theta(t),t)*l[I]" />
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations33.gif" width="66" height="27" alt="zd[1] := 0" />
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations34.gif" width="652" height="45" alt="xd[2] := -cos(theta(t))*diff(theta(t),t)*sin(alpha(t))*l[p]-sin(theta(t))*cos(alpha(t))*diff(alpha(t),t)*l[p]-sin(theta(t))*diff(theta(t),t)*l[I]" />
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations35.gif" width="656" height="45" alt="yd[2] := -sin(theta(t))*diff(theta(t),t)*sin(alpha(t))*l[p]+cos(theta(t))*cos(alpha(t))*diff(alpha(t),t)*l[p]+cos(theta(t))*diff(theta(t),t)*l[I]" />
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations36.gif" width="201" height="45" alt="zd[2] := sin(alpha(t))*diff(alpha(t),t)*l[p]" />
</p>
<p align="left">
</p>
</dl><dl><a name="MapleAutoBookmark10" />
<p align="left">
<b><font color="#000000" size="4">State-Space Variables</font></b>
</p>
<ul><li>
<font color="#000000">The chosen states should at least include the generalized coordinates and their first-time derivatives.</font>
</li>
<li>
<font color="#000000">X is the state vector.</font>
</li>
<li>
<font color="#000000">In the state vector X: Lagrangian coordinates are first, followed by their first-time derivatives, and finally any other states, as required.</font>
</li>
</ul>
<p align="left">
<font color="#000000">Substitution sets for the states (to obtain time-independent state equations).</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">subs_Xq := { seq( q[i] = X[i], i=1..Nq ) };<br />
subs_Xqd := { seq( qd[i] = X[i+Nq], i=1..Nq ) };</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations37.gif" width="244" height="27" alt="subs_Xq := {theta(t) = X[1], alpha(t) = X[2]}" />
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations38.gif" width="286" height="45" alt="subs_Xqd := {diff(theta(t),t) = X[3], diff(alpha(t),t) = X[4]}" />
</p>
<p align="left">
<font color="#000000">Control varible is tower motor input current.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">subs_U := { I[m,t] = U[1] };</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations39.gif" width="170" height="27" alt="subs_U := {I[m,t] = U[1]}" />
</p>
<p align="left">
<font color="#000000">Nu = number of inputs; U = input (row) vector (e.g. U = [ V[m] ] )</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Nu := nops( subs_U ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">substitution set for the position states' second time derivatives</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">subs_Xqdd := { seq( diff( q[i], t$2 ) = &nbsp;Xd[i+Nq], i=1..Nq ) };</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations40.gif" width="329" height="63" alt="subs_Xqdd := {diff(theta(t),`$`(t,2)) = Xd[3], diff(alpha(t),`$`(t,2)) = Xd[4]}" />
</p>
<p align="left">
<font color="#000000">second time derivatives of the position states (written as time-independent variables).</font>
</p>
<p align="left">
<font color="#000000">The set of unknowns is obtained from this list to solve the Lagrange's equations of motion.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Xqdd := [ seq( Xd[i+Nq], i=1..Nq ) ];</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations41.gif" width="144" height="27" alt="Xqdd := [Xd[3], Xd[4]]" />
</p>
<p align="left">
<font color="#000000">substitution set to linearize the state-space matrices (i.e. A and B) </font>
</p>
<p align="left">
<font color="#000000">about the quiescent null state vector (small-displacement theory)</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">subs_XUzero := { seq( X[i] = 0, i=1..2*Nq ), seq( U[i] = 0, i=1..Nu ) }:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">Nx = dim( X ) = total number of states (should be greater than or equal to: 2 * Nq)</font>
</p>
<p align="left">
<font color="#000000">Ny = chosen number of outputs</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Nx := 2 * Nq + 0:<br />
Ny := Nq:</font></b>
</td></tr>
</table>
</p>
</dl></dl><dl><a name="MapleAutoBookmark11" />
<p align="left">
<b><font color="#000000" size="5">Total Potential and Kinetic Energies of the System</font></b>
</p>
<p align="left">
<font color="#000000">The total potential and kinetic energies are needed to calculate the Lagrangian of the system.</font>
</p>
<dl><a name="MapleAutoBookmark12" />
<p align="left">
<b><font color="#000000" size="4">Total Potential Energy: </font></b>
<img src="images/3-DOF Crane Tower Equations42.gif" width="39" height="36" alt="V[T]" align="middle" />
<b><font color="#000000" size="4">&nbsp;</font></b>
</p>
<p align="left">
<font color="#000000">The total potential energy can be expressed in terms of the generalized coordinates alone.</font>
</p>
<p align="left">
<font color="#000000">V[e] = Total Elastic Potential Energy of the system</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">V[e] := 0: </font></b>
</td></tr>
</table>
</p>
<p align="left">
<img src="images/3-DOF Crane Tower Equations43.gif" width="34" height="32" alt="V[g]" align="middle" />
<font color="#000000">&nbsp;= potential energy of payload.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">V[g] := potential_energy( 'gravity', m[p], g, z[2] ); </font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations44.gif" width="180" height="27" alt="V[g] := -m[p]*g*cos(alpha(t))*l[p]" />
</p>
<p align="left">
<font color="#000000">V[T] = Total Potential Energy of the system</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">V[T] := simplify( V[g] + V[e] );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations45.gif" width="181" height="27" alt="V[T] := -m[p]*g*cos(alpha(t))*l[p]" />
</p>
<p align="left">
</p>
</dl><dl><a name="MapleAutoBookmark13" />
<p align="left">
<b><font color="#000000" size="4">Total Kinetic Energy: </font></b>
<img src="images/3-DOF Crane Tower Equations46.gif" width="38" height="36" alt="T[T]" align="middle" />
</p>
<p align="left">
<font color="#000000">The total kinetic energy can be expressed in terms of the generalized coordinates and their first-time derivatives.</font>
</p>
<p align="left">
<img src="images/3-DOF Crane Tower Equations47.gif" width="39" height="32" alt="T[r1]" align="middle" />
<font color="#000000">&nbsp;= kinetic energy due to rotation of arm</font>
</p>
<p align="left">
<img src="images/3-DOF Crane Tower Equations48.gif" width="35" height="32" alt="J[m]" align="middle" />
<font color="#000000">&nbsp;= moment of inertia of base motor, rotary arm, and the carriage.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Tr[1] := kinetic_energy( 'rotation', J[theta], qd[1] );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations49.gif" width="159" height="58" alt="Tr[1] := 1/2*J[theta]*diff(theta(t),t)^2" />
</p>
<p align="left">
<font color="#000000">Kinetic energy from the rotation of the payload about the </font>
<img src="images/3-DOF Crane Tower Equations50.gif" width="27" height="32" alt="alpha" align="middle" />
<font color="#000000">&nbsp;deflection gimble.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Tr[2] := kinetic_energy( 'rotation', J[alpha],qd[2] );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations51.gif" width="165" height="58" alt="Tr[2] := 1/2*J[alpha]*diff(alpha(t),t)^2" />
</p>
<p align="left">
<font color="#000000">v[2] = cartesian velocity of the mass (magnitude)</font>
</p>
<p align="left">
<font color="#000000">Tt[2] = translational kinetic kinergy of the mass</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">v := n_norm( [ xd[2], yd[2], zd[2] ], 2 ):<br />
Tt := simplify( kinetic_energy( 'translation', m[p], v) );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations52.gif" width="861" height="58" alt="Tt := 1/2*m[p]*(2*cos(alpha(t))*diff(alpha(t),t)*l[p]*diff(theta(t),t)*l[I]+diff(theta(t),t)^2*l[I]^2+diff(theta(t),t)^2*l[p]^2-diff(theta(t),t)^2*l[p]^2*cos(alpha(t))^2+diff(alpha(t),t)^2*l[p]^2)" />
</p>
<p align="left">
<font color="#000000">Total kinetic energy of 3D Crane tower subsystem</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">T[T] := Tr[1] + Tr[2] + Tt;<br />
T[T] := collect( T[T], diff ):</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations53.gif" width="1105" height="58" alt="T[T] := 1/2*J[theta]*diff(theta(t),t)^2+1/2*J[alpha]*diff(alpha(t),t)^2+1/2*m[p]*(2*cos(alpha(t))*diff(alpha(t),t)*l[p]*diff(theta(t),t)*l[I]+diff(theta(t),t)^2*l[I]^2+diff(theta(t),t)^2*l[p]^2-diff(th..." />
</p>
<p align="left">
</p>
</dl></dl><dl><a name="MapleAutoBookmark14" />
<p align="left">
<b><font color="#000000" size="5">Generalized Forces: </font></b>
<img src="images/3-DOF Crane Tower Equations54.gif" width="38" height="48" alt="Q[i]" align="middle" />
<b><font color="#000000" size="5">'s</font></b>
</p>
<p align="left">
<font color="#000000">The non-conservative forces corresponding to the generalized coordinates are: </font>
<img src="images/3-DOF Crane Tower Equations55.gif" width="48" height="32" alt="tau[m,j]" align="middle" />
<font color="#000000">&nbsp;and the viscous damping forces, where</font>
</p>
<p align="left">
<img src="images/3-DOF Crane Tower Equations56.gif" width="48" height="32" alt="tau[m,t]" align="middle" />
<font color="#000000">&nbsp;= torque generated by the tower motor that drives the rotary arm, i.e. jib</font>
</p>
<p align="left">
<img src="images/3-DOF Crane Tower Equations57.gif" width="33" height="32" alt="B[theta]" align="middle" />
<font color="#000000">&nbsp;= tower motor viscous friction torque coefficient (a.k.a. viscous damping)</font>
</p>
<p align="left">
<img src="images/3-DOF Crane Tower Equations58.gif" width="36" height="32" alt="B[alpha]" align="middle" />
<font color="#000000">&nbsp;= gimble </font>
<img src="images/3-DOF Crane Tower Equations59.gif" width="27" height="32" alt="alpha" align="middle" />
<font color="#000000">&nbsp;deflection viscous friction torque coefficient (a.k.a. viscous damping)</font>
</p>
<p align="left">
<font color="#000000">Set viscous dampings to zero to neglect</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">B[theta] := 0: <br />
B[alpha]:=0:<br />
</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">Q[i] = generalized force applied on generalized coordinate q[i]</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Q[1] := tau[m,t] - B[theta] * qd[1];</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations60.gif" width="87" height="27" alt="Q[1] := tau[m,t]" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Q[2] := - B[alpha] * qd[2];</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations61.gif" width="63" height="27" alt="Q[2] := 0" />
</p>
<p align="left">
<font color="#000000">Torques produced by the motor at the motor pinion (i.e. after the gearbox)</font>
</p>
<p align="left">
<img src="images/3-DOF Crane Tower Equations62.gif" width="48" height="32" alt="tau[m,t]" align="middle" />
<font color="#000000">&nbsp;= output torque from tower motor driving rotary arm</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">tau[m,t] := eta[g,t] * K[g,t] * eta[m,t] * K[t,t] * I[m,t];<br />
</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations63.gif" width="241" height="27" alt="tau[m,t] := eta[g,t]*K[g,t]*eta[m,t]*K[t,t]*I[m,t]" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Q := [ seq( Q[i], i=1..Nq ) ];</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations64.gif" width="250" height="27" alt="Q := [eta[g,t]*K[g,t]*eta[m,t]*K[t,t]*I[m,t], 0]" />
</p>
</dl><dl><a name="MapleAutoBookmark15" />
<p align="left">
<b><font color="#000000" size="5">Euler-Lagrange's Equations</font></b>
</p>
<p align="left">
<font color="#000000">For a </font>
<i><font color="#000000">N</font></i>
<font color="#000000">-DOF system, the Lagrange's equations can be written:</font>
</p>
<p align="left">
<img src="images/3-DOF Crane Tower Equations65.gif" width="217" height="58" alt="Diff(Diff(L,qdot[i]),t)-Diff(L,q[i]) = Q[i]" align="middle" />
<font color="#000000">&nbsp;&nbsp;for </font>
<img src="images/3-DOF Crane Tower Equations66.gif" width="45" height="32" alt="i = 1" align="middle" />
<font color="#000000">&nbsp;through </font>
<img src="images/3-DOF Crane Tower Equations67.gif" width="27" height="32" alt="N" align="middle" />
</p>
<p align="left">
<font color="#000000">where:</font>
</p>
<p align="left">
<font color="#000000">&nbsp;</font>
<img src="images/3-DOF Crane Tower Equations68.gif" width="31" height="32" alt="Q[i]" align="middle" />
<font color="#000000">'s are special combinations of external forces and called the </font>
<i><font color="#000000">generalized forces,</font></i>
</p>
<p align="left">
<i><font color="#000000">&nbsp;</font></i>
<img src="images/3-DOF Crane Tower Equations69.gif" width="32" height="32" alt="q[1]" align="middle" />
<font color="#000000">, ..., </font>
<img src="images/3-DOF Crane Tower Equations70.gif" width="35" height="32" alt="q[N]" align="middle" />
<font color="#000000">, are </font>
<i><font color="#000000">N </font></i>
<font color="#000000">independent coordinates chosen to describe the system and called the </font>
<i><font color="#000000">generalized coordinates</font></i>
<font color="#000000">,</font>
</p>
<p align="left">
<font color="#000000">&nbsp;and </font>
<img src="images/3-DOF Crane Tower Equations71.gif" width="25" height="32" alt="L" align="middle" />
<font color="#000000">&nbsp;is the </font>
<i><font color="#000000">Lagrangian</font></i>
<font color="#000000">&nbsp;of the system.</font>
</p>
<p align="left">
<img src="images/3-DOF Crane Tower Equations72.gif" width="25" height="32" alt="L" align="middle" />
<font color="#000000">&nbsp;is defined by:</font>
</p>
<p align="left">
<img src="images/3-DOF Crane Tower Equations73.gif" width="80" height="20" alt="L = T-U" />
</p>
<p align="left">
<font color="#000000">where </font>
<img src="images/3-DOF Crane Tower Equations74.gif" width="25" height="32" alt="T" align="middle" />
<font color="#000000">&nbsp;is the total kinetic energy of the system and </font>
<img src="images/3-DOF Crane Tower Equations75.gif" width="28" height="32" alt="U" align="middle" />
<font color="#000000">&nbsp;the total potential energy of the system.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">EOM_orig := lagrange_equations( T[T], V[T], q, Q ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">this is to display the EOM's</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">EOM_orig := collect( EOM_orig, { seq( diff( q[i], t$2 ), i=1..Nq ), seq( diff( q[i], t ), i=1..Nq ), seq( q[i], i=1..Nq ) } ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">Express the Euler-Lagrange equations of motion as functions of the states:</font>
</p>
<p align="left">
<font color="#000000">1) substitute (i.e. name) the acceleration states first! </font>
</p>
<p align="left">
<font color="#000000">2) then substitute the velocity states!</font>
</p>
<p align="left">
<font color="#000000">3) and only after, the position states, and the inputs!</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">EOM_states := subs( subs_Xqd, subs( subs_Xqdd, EOM_orig ) ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">EOM_states := subs( subs_Xq, subs_U, EOM_states ):</font></b>
</td></tr>
</table>
</p>
<dl><a name="MapleAutoBookmark16" />
<p align="left">
<b><font color="#000000" size="4">Linearization &nbsp;in the EOM's</font></b>
<font color="#000000" size="4">&nbsp;</font>
<b><font color="#000000" size="4">of the Trigonometric Functions</font></b>
</p>
<p align="left">
<font color="#000000">Linearization of the equations of motion around the quiescent point of operation (in order to solve them).</font>
</p>
<p align="left">
<font color="#000000">Here, linearization around the zero angles, i.e. for small-amplitude oscillations.</font>
</p>
<p align="left">
<font color="#000000">Linearization around: alpha0 = 0, and alpha_dot0 = 0</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">EOM_ser := EOM_states:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">Generalized series expansions of the trigonometric functions is used (for small angles).</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do<br />
&nbsp;&nbsp;for k from 1 to 3 do<br />
&nbsp;&nbsp;&nbsp;&nbsp;EOM_ser[i] := subsop( 1 = convert( series( op( 1, EOM_ser[i] ), X[ k+1 ] ), polynom ), EOM_ser[i] );<br />
&nbsp;&nbsp;end do:<br />
&nbsp;&nbsp;EOM_ser[i] := simplify( EOM_ser[i] );<br />
end do:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">EOM_ser;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations76.gif" width="936" height="29" alt="[Xd[3]*J[theta]+Xd[3]*m[p]*l[I]^2+m[p]*Xd[4]*l[p]*l[I]+2*m[p]*l[p]^2*X[4]*X[2]*X[3] = eta[g,t]*K[g,t]*eta[m,t]*K[t,t]*U[1], m[p]*l[p]*l[I]*Xd[3]+Xd[4]*J[alpha]+Xd[4]*m[p]*l[p]^2+m[p]*g*l[p]*X[2] = 0]" />
</p>
<p align="left">
</p>
</dl><dl><a name="MapleAutoBookmark17" />
<p align="left">
<b><font color="#000000" size="4">Additional Insight: Inertia (or mass) Matrix: Fi</font></b>
</p>
<p align="left">
<font color="#000000">The nonlinear system of equations resulting from the Lagrangian mechanics can be written in the following matrix form:</font>
</p>
<p align="left">
<font color="#000000">F( q ) . qdd + G( q, qd ) . qd + H( q ) . q = L( q, qd, u )</font>
</p>
<p align="left">
<font color="#000000">F, G, and H are called, respectively, the mass, damping, and stiffness matrices.</font>
</p>
<p align="left">
<font color="#000000">They are symmetric in form.</font>
</p>
<p align="left">
<font color="#000000">The inertia (a.k.a. mass) matrix, F, gives indications regarding the coupling existing in the system.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Fi := Matrix( Nq, Nq ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do<br />
&nbsp;&nbsp;for k from 1 to Nq do<br />
&nbsp;&nbsp;&nbsp;&nbsp;Fi[ i, k ] := simplify( diff( op( 1, EOM_states[i] ), Xd[k+Nq] ) );<br />
&nbsp;&nbsp;&nbsp;&nbsp;Fi[ i, k ] := collect( combine( Fi[ i, k ], trig ), cos );<br />
&nbsp;&nbsp;end do;<br />
end do:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">'F[i]' = Fi;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations77.gif" width="472" height="84" alt="F[i] = Matrix(%id = 19377460)" />
</p>
<p align="left">
<font color="#000000">Linearization of the inertia matrix for small-displacements</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Fi_lin := Matrix( Nq, Nq ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do<br />
&nbsp;&nbsp;for k from 1 to Nq do<br />
&nbsp;&nbsp;&nbsp;&nbsp;Fi_lin[ i, k ] := Fi[ i, k ];<br />
&nbsp;&nbsp;&nbsp;&nbsp;Fi_lin[ i, k ] := convert( series( Fi_lin[ i, k ], X[ k ] ), polynom );<br />
&nbsp;&nbsp;&nbsp;&nbsp;Fi_lin[ i, k ] := subs( subs_XUzero, Fi_lin[ i, k ] );<br />
&nbsp;&nbsp;end do; <br />
end do:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">'F_lin' = Fi_lin;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations78.gif" width="249" height="68" alt="F_lin = Matrix(%id = 19440388)" />
</p>
<p align="left">
</p>
</dl></dl><dl><a name="MapleAutoBookmark18" />
<p align="left">
<b><font color="#000000" size="5">Solving the Euler-Lagrange's Equations</font></b>
</p>
<dl><a name="MapleAutoBookmark19" />
<p align="left">
<b><font color="#000000" size="4">Reverse State Substitution for Pretty Display of the Solved EOM's</font></b>
</p>
<p align="left">
<font color="#000000">only for pretty print</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">subs_Xq_rev := { seq( X[i] = q[i], i=1..Nq ) }:<br />
subs_Xqd_rev := { seq( X[i+Nq] = qd[i], i=1..Nq ) }:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">subs_U_rev := { U[1] = I[m,t] };<br />
</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations79.gif" width="199" height="27" alt="subs_U_rev := {U[1] = I[m,t]}" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">eom_collect_list := { seq( diff( q[i], t ), i=1..Nq ), seq( q[i], i=1..Nq ), J[theta], J[alpha] };</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations80.gif" width="380" height="45" alt="eom_collect_list := {J[theta], J[alpha], theta(t), alpha(t), diff(theta(t),t), diff(alpha(t),t)}" />
</p>
<p align="left">
</p>
</dl><p align="left">
</p>
<dl><a name="MapleAutoBookmark20" />
<p align="left">
<b><font color="#000000" size="4">Solution to the Non-Linear Equations of Motion</font></b>
</p>
<p align="left">
<font color="#000000">Solve the non-linear form of the equations of motion for the states' second time derivatives</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Xqdd_solset_nl := solve( convert( EOM_states, set ), convert( Xqdd, set ) ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">assign( Xqdd_solset_nl );</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do <br />
&nbsp;&nbsp;Xd_nl[i+Nq] := simplify( Xd[i+Nq] ):<br />
&nbsp;&nbsp;unassign( 'Xd[i+Nq]' ):<br />
end do:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">pretty display w.r.t. the named system states</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do<br />
&nbsp;Xd_nl[i+Nq] := simplify( subs( subs_U_rev, subs_Xq_rev, subs_Xqd_rev, Xd_nl[i+Nq] ) ):<br />
end do:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do<br />
&nbsp;&nbsp;diff( qd[i], t ) = collect( Xd_nl[i+Nq], eom_collect_list );<br />
end do:</font></b>
</td></tr>
</table>
</p>
</dl><dl><a name="MapleAutoBookmark21" />
<p align="left">
<b><font color="#000000" size="4">Solution to the Linearized EOM's</font></b>
</p>
<p align="left">
<font color="#000000">Solve the linear form of the equations of motion for the states' second time derivatives</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Xqdd_solset_ser := solve( convert( EOM_ser, set ), convert( Xqdd, set ) ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">assign( Xqdd_solset_ser );</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">Moreover, for small angles</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">subs_avsq_list := { X[Nq+2]^2 = 0, X[Nq+3]^2 = 0 }:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do<br />
&nbsp;&nbsp;Xd[i+Nq] := subs( subs_avsq_list, Xd[i+Nq] );<br />
end:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">pretty display w.r.t. the named system states</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do<br />
&nbsp;&nbsp;diff( qd[i], t ) = collect( subs( subs_U_rev, subs_Xq_rev, subs_Xqd_rev, Xd[i+Nq] ), eom_collect_list );<br />
end do:</font></b>
</td></tr>
</table>
</p>
<p align="left">
</p>
</dl></dl><dl><a name="MapleAutoBookmark22" />
<p align="left">
<b><font color="#000000" size="5">Determine the System State-Space Matrices: A, B, C, and D</font></b>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">A_ss := Matrix( Nx, Nx ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">A_ss := deriveA( Xqdd, A_ss, Nq, subs_XUzero ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">'A' = A_ss;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations81.gif" width="343" height="196" alt="A = Matrix(%id = 19484936)" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">B_ss := Matrix( Nx, Nu ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">B_ss := deriveB( Xqdd, B_ss, Nq, subs_XUzero ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">'B' = B_ss;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations82.gif" width="295" height="194" alt="B = Matrix(%id = 954380)" />
</p>
<p align="left">
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">C_ss := IdentityMatrix( Ny, Nx ):<br />
'C' = C_ss;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations83.gif" width="156" height="50" alt="C = Matrix(%id = 581916)" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">D_ss := Matrix( Ny, Nu, 0 ):<br />
'D' = D_ss;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/3-DOF Crane Tower Equations84.gif" width="81" height="50" alt="D = Matrix(%id = 768712)" />
</p>
<p align="left">
</p>
</dl><p align="left">
</p>
<dl><a name="MapleAutoBookmark23" />
<p align="left">
<b><font color="#000000" size="5">Write A, B, C, and D to a Matlab file</font></b>
</p>
<p align="left">
<font color="#000000">Save the state-space matrices A, B, C and D to a MATLAB file.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Matlab_File_Name := "CRANE_TOWER_ABCD_eqns.m":</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">substitution set containing a notation consistent with that used in the MATLAB design script(s)</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Matlab_Notations := {m[p] = mp, l[p] = lp, l[j] = lj, J[theta] = J_theta, J[alpha]=J_alpha, K[t,t] = Kt_t, eta[m,t] = eff_m_t, K[g,t] = Kg_t, eta[g,t] = eff_g_t }:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Experiment_Name := "3D CRANE":</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">write_ABCD_to_Mfile( Matlab_File_Name, Experiment_Name, Matlab_Notations, A_ss, B_ss, C_ss, D_ss );</font></b>
</td></tr>
</table>
</p>
</dl><dl><a name="MapleAutoBookmark24" />
<p align="left">
<b><font color="#000000" size="5">Procedure Printing</font></b>
</p>
<p align="left">
<font color="#000000">default:</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">interface( verboseproc = 1 );</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">eval( lagrange_equations ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"></td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"></td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"></td></tr>
</table>
</p>
<p align="left">
</p>
</dl><p align="left">
<a href="3-DOF Crane Tower Equations1.html#Description" target="Content">Click here to go back to top: Description Section</a><font color="#000000">.</font>
</p>
</basefont>
</body>
</html>
